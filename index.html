<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>English Practice — 單字測驗</title>
		<link rel="stylesheet" href="styles.css">
	</head>
	<body>
		<main class="container">
			<h1>English Practice</h1>
			<p>根據字義填寫詞性與單字。</p>

		<nav class="nav">
			<a class="btn" href="quiz.html">開始測驗</a>
			<a class="btn" href="add.html">新增單字</a>
		</nav>

		<section id="summary">
			<p>目前單字數：<span id="wordCount">0</span></p>
		</section>

		<section id="backend" class="muted">
			<p style="margin-top: 20px; font-size: 0.9em;">後端功能（需啟動伺服器）：</p>
			<nav class="nav">
				<a class="btn secondary" href="manage.html">管理單字</a>
			</nav>
		</section>			
		</main>

		<script src="app.js"></script>
		<script>
			// 在主頁顯示單字數量：優先向後端取得 active=true 的數量，若失敗則顯示 localStorage 的非 sample 單字
			document.addEventListener('DOMContentLoaded', async ()=>{
				const wordCountEl = document.getElementById('wordCount');
				
				// 優先嘗試從後端取得 active=true 的單字數
				try{
					const res = await fetch('/api/words?active=true');
					if (res.ok){
						const words = await res.json();
						if (words && Array.isArray(words)){
							wordCountEl.textContent = words.length;
							return;
						}
					}
				}catch(e){
					// 無法連線到伺服器，使用 localStorage
				}

				// 回退：顯示 localStorage 的非 sample 單字數
				if (window.vocab) window.vocab.ensureSample();
				const words = window.vocab ? window.vocab.getWords() : [];
				const count = (words || []).filter(w => !w.sample).length;
				wordCountEl.textContent = count;
			});
		</script>
	</body>
</html>
